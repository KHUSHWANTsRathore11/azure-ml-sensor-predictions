#!/bin/bash
# Quick reference commands for Azure ML operations

echo "üöÄ Azure ML Quick Reference Commands"
echo "================================================"
echo ""

# Workspace info
echo "üìÅ Workspace Operations:"
echo "   List workspaces:"
echo "   az ml workspace list --resource-group <rg-name> -o table"
echo ""
echo "   Show workspace:"
echo "   az ml workspace show --name <workspace-name> --resource-group <rg-name>"
echo ""

# Environment
echo "üêç Environment Operations:"
echo "   Register environment:"
echo "   az ml environment create --file components/environments/sensor-forecasting-env.yaml --workspace-name <ws> --resource-group <rg>"
echo ""
echo "   List environments:"
echo "   az ml environment list --workspace-name <ws> --resource-group <rg> -o table"
echo ""
echo "   Show environment:"
echo "   az ml environment show --name sensor-forecasting-env --workspace-name <ws> --resource-group <rg>"
echo ""

# Components
echo "üì¶ Component Operations:"
echo "   Register training component:"
echo "   az ml component create --file components/training/train-lstm-model/component.yaml --workspace-name <ws> --resource-group <rg>"
echo ""
echo "   Register scoring component:"
echo "   az ml component create --file components/scoring/batch-score/component.yaml --workspace-name <ws> --resource-group <rg>"
echo ""
echo "   List components:"
echo "   az ml component list --workspace-name <ws> --resource-group <rg> -o table"
echo ""
echo "   Show component:"
echo "   az ml component show --name train_lstm_model --workspace-name <ws> --resource-group <rg>"
echo ""

# Data assets (MLTable)
echo "üìä Data Asset Operations:"
echo "   Register MLTable:"
echo "   az ml data create --name PLANT001_CIRCUIT01 --version 2025-11-01 --type mltable \\"
echo "     --path azureml://datastores/workspaceblobstore/paths/mltable/PLANT001_CIRCUIT01/ \\"
echo "     --workspace-name <ws> --resource-group <rg>"
echo ""
echo "   List data assets:"
echo "   az ml data list --workspace-name <ws> --resource-group <rg> -o table"
echo ""
echo "   Show data asset:"
echo "   az ml data show --name PLANT001_CIRCUIT01 --version 2025-11-01 --workspace-name <ws> --resource-group <rg>"
echo ""
echo "   List versions of data asset:"
echo "   az ml data list --name PLANT001_CIRCUIT01 --workspace-name <ws> --resource-group <rg> -o table"
echo ""

# Jobs (Pipelines)
echo "üèãÔ∏è  Job Operations:"
echo "   Submit training pipeline:"
echo "   az ml job create --file pipelines/single-circuit-training.yaml \\"
echo "     --workspace-name <ws> --resource-group <rg> \\"
echo "     --set inputs.circuit_config.path='config/circuits/PLANT001_CIRCUIT01.yaml' \\"
echo "     --set inputs.training_data.path='azureml:PLANT001_CIRCUIT01:2025-11-01'"
echo ""
echo "   List jobs:"
echo "   az ml job list --workspace-name <ws> --resource-group <rg> -o table"
echo ""
echo "   Show job:"
echo "   az ml job show --name <job-name> --workspace-name <ws> --resource-group <rg>"
echo ""
echo "   Stream job logs:"
echo "   az ml job stream --name <job-name> --workspace-name <ws> --resource-group <rg>"
echo ""
echo "   Download job outputs:"
echo "   az ml job download --name <job-name> --workspace-name <ws> --resource-group <rg>"
echo ""

# Models
echo "ü§ñ Model Operations:"
echo "   List models:"
echo "   az ml model list --workspace-name <ws> --resource-group <rg> -o table"
echo ""
echo "   Show model:"
echo "   az ml model show --name plant001-circuit01 --workspace-name <ws> --resource-group <rg>"
echo ""
echo "   List model versions:"
echo "   az ml model list --name plant001-circuit01 --workspace-name <ws> --resource-group <rg> -o table"
echo ""
echo "   Tag model:"
echo "   az ml model update --name plant001-circuit01 --version 1 \\"
echo "     --add-tag cutoff_date=2025-11-01 \\"
echo "     --add-tag validated=true \\"
echo "     --workspace-name <ws> --resource-group <rg>"
echo ""
echo "   Query by tag:"
echo "   az ml model list --workspace-name <ws> --resource-group <rg> --tag cutoff_date=2025-11-01 -o table"
echo ""

# Batch endpoints
echo "üéØ Batch Endpoint Operations:"
echo "   Create batch endpoint:"
echo "   az ml batch-endpoint create --name be-plant001-circuit01 --workspace-name <ws> --resource-group <rg>"
echo ""
echo "   Create batch deployment:"
echo "   az ml batch-deployment create --name deployment-v1 --endpoint-name be-plant001-circuit01 \\"
echo "     --model azureml:plant001-circuit01:1 --workspace-name <ws> --resource-group <rg>"
echo ""
echo "   List batch endpoints:"
echo "   az ml batch-endpoint list --workspace-name <ws> --resource-group <rg> -o table"
echo ""
echo "   Invoke batch endpoint:"
echo "   az ml batch-endpoint invoke --name be-plant001-circuit01 \\"
echo "     --input azureml:test-data:latest --workspace-name <ws> --resource-group <rg>"
echo ""

# Useful queries
echo "üîç Useful Queries:"
echo "   Find all resources for a circuit:"
echo "   az ml data list --name PLANT001_CIRCUIT01 --workspace-name <ws> --resource-group <rg>"
echo "   az ml job list --tag circuit_id=CIRCUIT01 --workspace-name <ws> --resource-group <rg>"
echo "   az ml model list --tag circuit_id=CIRCUIT01 --workspace-name <ws> --resource-group <rg>"
echo ""
echo "   Find all resources with cutoff_date:"
echo "   az ml job list --tag cutoff_date=2025-11-01 --workspace-name <ws> --resource-group <rg>"
echo "   az ml model list --tag cutoff_date=2025-11-01 --workspace-name <ws> --resource-group <rg>"
echo ""

# Local testing
echo "üß™ Local Testing:"
echo "   Generate circuit configs:"
echo "   python3 scripts/generate_circuit_configs.py"
echo ""
echo "   Detect changes:"
echo "   python3 scripts/detect_config_changes.py --target-branch main"
echo ""
echo "   Test setup:"
echo "   ./scripts/test_setup.sh <workspace-name> <resource-group>"
echo ""

echo "================================================"
echo "üí° Tips:"
echo "   - Use -o table for readable output"
echo "   - Use --query for specific fields"
echo "   - Use --tag for filtering by tags"
echo "   - Add --help to any command for details"
echo "================================================"
